<!doctype html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Finance Upload Unified</title>
    <link rel="stylesheet" href="/static/style.css" />
  </head>
  <body>
    <main class="container">
      <header class="page-header">
        <span class="header-icon" aria-hidden="true">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="12" y1="18" x2="12" y2="12"/><line x1="9" y1="15" x2="15" y2="15"/></svg>
        </span>
        <h1>Finance Upload Unified</h1>
        <p class="subtitle">อัปโหลดไฟล์ Excel, ดู Preview, ดาวน์โหลดผลลัพธ์ หรือส่งเข้าฐานข้อมูล SQL Server ได้ ทันที</p>
      </header>

      <section class="card">
        <h2 class="card-title"><span class="step-num">1</span> เลือกไฟล์และตั้งค่า</h2>
        <label for="excel-file" class="upload-zone">
          <input id="excel-file" type="file" accept=".xlsx,.xls" class="upload-input" />
          <span class="upload-icon">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
          </span>
          <span class="upload-text"><span class="upload-link">Click to upload</span> or drag and drop</span>
          <span class="upload-hint">Excel files (XLSX, XLS) or CSV</span>
        </label>
        <div class="grid">
          <label class="field-label">Finance Sent Label <input id="label-sent" value="ส่งไฟแนนซ์" /></label>
          <label class="field-label">Finance Broker Label <input id="label-broker" value="นายหน้าไฟแนนซ์" /></label>
          <label class="field-label">Duplicate Mode
            <input type="hidden" id="duplicate-mode" value="group" />
            <span class="field-value">group</span>
          </label>
        </div>
        <div class="actions">
          <button type="button" id="btn-preview" class="btn btn-preview"><span class="btn-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg></span> Preview</button>
          <button type="button" id="btn-download" class="btn btn-export-excel"><span class="btn-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/></svg></span> Export excel</button>
          <button type="button" id="btn-import" class="btn btn-upload"><span class="btn-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg></span> Upload</button>
        </div>
      </section>

      <section class="card">
        <h2 class="card-title"><span class="step-num">2</span> ผลลัพธ์</h2>
        <div class="results-area">
          <div class="results-placeholder">
            <span class="empty-icon results-icon" aria-hidden="true">
              <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
            </span>
            <pre id="summary">ยังไม่มีผลลัพธ์</pre>
            <p class="results-hint">อัปโหลดไฟล์และกดปุ่ม Transform เพื่อเริ่มทํางาน</p>
          </div>
        </div>
      </section>

      <section class="card">
        <h2 class="card-title"><span class="step-num">3</span> Preview (สูงสุด 200 แถว)</h2>
        <div class="preview-area">
          <div class="preview-placeholder">
            <span class="empty-icon preview-icon" aria-hidden="true">
              <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><line x1="10" y1="9" x2="8" y2="9"/></svg>
            </span>
            <p class="preview-empty-title">No Data to Preview</p>
            <p class="preview-empty-hint">ข้อมูลตัวอย่างจะแสดงที่นี่หลังจากอัปโหลด</p>
          </div>
          <div class="table-wrap">
            <table id="preview-table"></table>
          </div>
        </div>
      </section>
    </main>
    <script src="/static/app.js"></script>
  </body>
</html>
